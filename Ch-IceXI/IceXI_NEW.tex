\chapter{On Algorithms for Building and Sampling Disordered Crystal States}
\label{ch:iceXI}

% Introduction
	 % Literature Review
% Experiment setup and result
% Future/Ongoing Work (maybe disclude)

\section{States and Properties of Ice}

Ice is cool. 
Ice has many forms, each with unique environments and structures that give rise to similar and unique properties. 

\subsection{Bernal-Fowler Ice Rules}

Bernal-Fowler Ice Rules are the basic rules for how water molecules interact in an ice structure.
DETAILS ON BF PAPER

Basically, water's tetrahedral structure allows for four interactions on each molecule. 
The two protons allow for a hydrogen bond with a lone pair from a neighboring oxygen atom.
Similarly, the oxygen atom's two lone pairs allow for a hydrogen bond with a neighboring proton. 
These rules are fairly rigid in the sense that every water molecule can interact with two oxygen atoms and two protons from four surrounding water molecules.
These are also free-form in the sense that each of the four attached water molecules can occupy one of three rotational microstates, allowing for 81 possible configurations (including rotational duplicates).

\subsection{Forms of Ice}

While ubiquitous in the 'I$_{h}$' form, ice water has many known forms.
As of the writing of this work, there are 17 established forms of ice. 
These forms usually occur in cubic, hexagonal, and orthorhombic crystal structures.
The relationship between external pressure and temperature are the primary defining characteristics of which form will form in a given system. 
Do other characteristics come into play??????? %FIND OUT


\subsection{Ice I$_{h}$}

As the most commonly found form on earth, ice I$_{h}$ is a highly desired form for computational studies involving ice systems. 
%structure
%P/T deets

\subsection{Efforts to Generate Ice I$_{h}$}

Has anyone else published efforts to generate Ice I$_{h}$?
I'm sure someone has.


\subsection{Comparison between Ice XI and Ice I$_{h}$}

While ice I$_{h}$ is known as the most common form of ice found on the planet, it is much more difficult to computationally generate than an ice XI crystal. 
The ease of generation of an ice XI structure stems from the repetition of a unit cell with consistent layering and orientation throughout the crystal lattice. 


With ice I$_{h}$ crystals, the proton-disordered form introduces entropy by way of rotational disorder. 
As the protons and lone pairs are no longer consistently ordered, hydrogen bonds may no longer form properly at all interaction sites. 
The interaction of proton with proton or lone pair with lone pair are not hydrogen bonds and are considered defects in the lattice. 
An ice structure of randomly oriented molecules without consideration of hydrogen bonds will likely produce defects at many interaction sites across the lattice and weaken the integrity of the system, leading to stability problems while running simulations. 
In generating the crystal, the cause of these defects must be considered and countered effectively.

%sub-ish section: necessary attributes to change to convert XI to Ih


\section{Method Design}

% overview
% 0. get pdb ice xi DONE
% 1. read in pdb ice xi
% 2. identify molecules (H2O)
% 3. identify molecule neighbors
% 4. identify corners/edges (in progress)
% 5. for each molecule, identify the tetrahedral spaces
% 6. for each molecule, "randomly" place the two protons
% 7. Check hydrogen bond defect rate
% 8. Fix as necessary (in progress)

\subsection{Overview}

The big idea is to convert an easy-to-make ice XI crystal into an ice Ih crystal.
Because the key difference in structure is the proton-orderedness, it might be possible to rearrange the water molecule orientations in a pseudorandom way to create an ice Ih crystal.

\subsection{Selection of Methods}

Python was chosen as the language of the tool due to the versatility of the language and the ease of development due to the "pseudocode" written style of the language and the availability of scientific packages including SciPy and NumPy. 
Python version 2.7 was specifically chosen due to familiarity with the language.
Crystal files where defined and saved as Protein Data Bank (.pdb) files as this format allows for defining multiple molecules within a larger structure with a simple X, Y, Z grid position format. 

\subsection{Generation of Source Ice XI}

This is Dr. Fennell's method to create an ice XI pdb file.

\subsection{Source Ingestion}

It is important that the crystal be read and stored in an efficient method to keep relevant information about each molecule easily accessible. 
As the file is read in, each molecule is stored as an entry in a multidimensional array where the first index is the molecule number. 
Further, the second index defines the molecule number where 0 is oxygen and 1 and 2 are the protons. 
The third, fourth, and fifth indices define the X, Y, and Z position coordinates. 

\subsubsection{Identifying Neighboring Molecules}

Identifying the neighboring molecules proved computationally difficult. 
The most effective method is to find the closest four molecules by computing a distance calculation between every two oxygen atoms.
This ensures every molecule is considered, but also presents significant hurdles.
First, a distance calculation utilizes an extremely computationally-inefficient square root calculation, which can be ignored by instead calculating the squared-distance between molecules and finding the lowest values.
Second, molecules on the walls and edges of the molecule will not have four neighbors in the non-periodic crystal. 
This is accounted for by shifting all six sides to make a pseudo-periodicity for these edge cases. 
Those periodically-neighboring molecules are flagged with a shifting value in the neighboring atom array by specifying a positive or negative shift in the x, y, or z axis values. 

\section{Results}

\section{Ongoing and Planned Work}














